# -*- coding:utf-8; tab-width:4; mode:python -*-

TestBG(
    './Server --Ice.Config=../hello.cfg',
    cwd = '$testdir',
    stdout = '$testdir/server.proxy')

Test(
    './Client-end "$(head -1 server.proxy)" 4',
    shell = True,
    cwd = '$testdir',
    pre = Poll(FileContains('hello1', '$testdir/server.proxy')),
    post = StdOutContains('24'))

Test(
    './Client-callback "$(head -1 server.proxy)" 4',
    shell = True,
    cwd = '$testdir',
    pre = Poll(FileContains('hello1', '$testdir/server.proxy')),
    post = StdOutContains('24'))

