# -*- coding:utf-8; tab-width:4; mode:python -*-

java = 'java -classpath $testdir:/usr/share/java/Ice.jar'

def client_test(client):
    return Test(
        '%s %s "$(head -1 server.proxy)" 4' % (java, client),
        shell = True,
        cwd = '$testdir',
        pre = Poll(FileContains('hello1', '$testdir/server.proxy')),
        post = StdOutContains('24'))


TestBG(
    '%s Server --Ice.Config=./hello.cfg' % java,
    cwd = '$testdir',
    stdout = '$testdir/server.proxy')

client_test('./Client_end')
client_test('./Client_callback')
